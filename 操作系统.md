# 第一章：操作系统概述

## 1.概念和功能

## 2.操作系统的四个特征

## 3.操作系统发展与分类

1. 手工操作阶段s
   1. 缺点：效率极其低下，资源利用率极低s
2. 单道批处理系统
   1. 优点：缓解了一定程度的人机速度矛盾，资源利用率有所提升
   2. 缺点：内存中仅能有一道程序运行，只有该程序结束后才能调入下一道程序。CPU有大量时间是等待I/O完成，资源利用率依然很低
3. 多道批处理系统
   1. 优点：多道程序并发执行，共享计算机资源 ，资源利用率大幅提升
   2. 缺点：用户响应时间长，没有人机交互的功能（用户提交自己的作业后，只能等待计算机处理完成，中间不能控制自己的作业执行）
4. 分时操作系统
   1. 优点：解决了人机交互的问题
   2. 缺点：不能优先处理一些紧急的任务，不区分任务的紧急性
5. 实时操作系统
   1. 优点：能在严格的时间限制内处理完事件，具有及时性和可靠性
   2. 缺点：
   3. 分为硬实时系统和软实时系统
6. 网络操作系统
7. 分布式操作系统
8. 个人计算机操作系统

## 4.运行机制

### 1.两种程序

1. 普通应用程序：平时普通人所使用的软件
2. 内核程序：
   1. **由许多操作系统程序组成操作系统内核**
   2. 内核时操作系统最核心的部分

### 2.两种指令

1. 特权指令
2. 非特权指令

应用程序只能执行非特权指令，CPU执行特权指令

### 3.内核态和用户态

处于内核态，此时运行的是内核程序，此时可以执行特权指令

处于用户态，此时运行的是应用程序，此时可以执行非特权指令

### 4.内核态和用户态切换

**内核态 —> 用户态：**执行一条**特权指令 —— 修改 PSW** 的标志位为“用户态”，这个动作意味着操作系统将主动让出 CPU 使用权

**用户态 —> 内核态：**由“**中断**”引发，**硬件自动完成变态过程**，触发中断信号意味着操作系统将强行夺回 CPU 的使用权

**触发中断信号：**除了非法使用特权指令之外，**但凡需要操作系统介入的地方**，都会触发中断信号

## 5.中断和异常

### 1.中断

中断是让操作系统内核夺回cpu使用权的唯一途径

1. 内中断 **（也成为异常）**：中断信号来自cpu内部，与当前执行的指令有关
   1. 陷阱，陷入：又陷入指令引发，是应用程序故意引发
   2. 故障：由错误条件引起，可能被内核程序修复，修复后cpu会把使用权还给应用程序
   3. 终止：由致命错误引起，内核程序无法修复错误，一般直接终止应用程序
2. 外中断：中断信号来自cpu外部，与当前执行的指令无关



### 2.中断原理

1. **中断处理程序一定是内核程序，一定要处于内核态**
2. 不同的中断信号，需要不同的中断处理程序来处理，检测到中断信号后，去查询中断向量表，以此来找到中断处理程序在内存中的存放位置



## 6.系统调用

### 1.什么是系统调用

操作系统作为用户和计算机硬件之间的接口，需要向上提供一吸纳简单易用的服务，主要包括命令接口和程序接口，其中，程序接口由一组系统调用组成



系统调用是操作系统提供给应用程序，使用的接口，可以理解为一种可提供应用程序调用的特殊函数，应用程序可以通过系统调用来请求获得操作系统内核的服务

### 2.需要系统调用的功能

1. 设备管理：完成设备的请求/释放/启动等
2. 文件管理：文成文件的读写，创建，删除等
3. 进程控制：文成进程的创建/撤销/阻塞/唤醒等
4. 进程通讯：完成进程之间的消息传递/信号传递等
5. 内存管理：完成内存的分配回收等功能

### 系统调用的过程

传递系统禅师

执行陷入指令

执行相应的请求内核程序处理的系统调用

返回应用程序

## 7.操作系统体系结构

操作系统分为非内核功能和内核部分

内核包括：进程管理，存储器管理，设备管理，时钟管理，中断处理，原语等功能

### 1分层结构

1. 特性：内核分层多，每层可以单向调用更第一层提供的接口
2. 优点
   1. 便于调试和维护，自底向上逐层调试验证
   2. 易于调试和维护，各层之间调用的接口清晰固定
3. 缺点：
   1. 仅可调用相邻的低层，难以合理定义各层的边界
   2. 效率低，不可跨层调用，系统调用执行效率低
